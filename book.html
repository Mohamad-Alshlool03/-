<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>احجز موعدًا الآن | مركز الأبرز</title>

  <!-- سياسة أمان (CSP) تناسب الموارد المستخدمة -->
  <meta http-equiv="Content-Security-Policy"
        content="default-src 'self';
                 img-src 'self' https: data:;
                 style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://cdnjs.cloudflare.com;
                 font-src 'self' https://fonts.gstatic.com https://cdnjs.cloudflare.com;
                 script-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com;
                 connect-src 'self' https://formsubmit.co;
                 form-action https://formsubmit.co;
                 frame-ancestors 'none';
                 base-uri 'self';
                 upgrade-insecure-requests">

  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <style>
    /* ========= نظام ألوان عبر متغيرات ========= */
    :root{
      --brand:#009fe3;
      --brand-2:#2c7a7b;

      /* Light (افتراضي) */
      --bg:#f4f8fb;
      --card:#ffffff;
      --text:#1f2937;
      --muted:#475569;
      --line:#e2e8f0;

      --input-bg:#ffffff;
      --input-text:#1f2937;
      --input-border:#e2e8f0;

      --header-fg:#ffffff;
    }
    /* Dark Theme */
    body.theme-dark{
      --bg:#0b1324;
      --card:#0f172a;
      --text:#e2e8f0;
      --muted:#cbd5e1;
      --line:#1f2937;

      --input-bg:#0b1e34;
      --input-text:#e2e8f0;
      --input-border:#1f2a3b;

      --header-fg:#eaf6ff;
    }

    /* ========= أساسيات ========= */
    *{box-sizing:border-box}
    html{ -webkit-text-size-adjust:100%; -moz-text-size-adjust:100%; text-size-adjust:100%; scroll-behavior:smooth; }
    body{ margin:0; font-family:'Cairo',sans-serif; background:var(--bg); color:var(--text); line-height:1.7; padding:20px; }

    .wrap{
      max-width:900px; margin:0 auto; background:var(--card);
      border:1px solid var(--line); border-radius:16px;
      box-shadow:0 10px 30px rgba(0,0,0,.06); overflow:hidden;
    }

    header{
      position:relative;
      background:linear-gradient(135deg,var(--brand),var(--brand-2));
      color:var(--header-fg); padding:28px 20px; text-align:center;
    }
    header h1{ margin:0 0 6px; font-size:1.8rem }
    header p{ margin:0; opacity:.95 }

    /* زر تبديل الثيم */
    .theme-toggle{
      position:absolute; top:12px; left:12px;
      width:38px; height:38px; border:none; border-radius:50%;
      background:rgba(255,255,255,.22); color:#fff; backdrop-filter:blur(6px);
      display:flex; align-items:center; justify-content:center; cursor:pointer; transition:.2s;
    }
    .theme-toggle:hover{ background:rgba(255,255,255,.3) }
    body.theme-dark .theme-toggle{ background:rgba(0,0,0,.28); color:#fff }

    .content{ padding:26px 18px }
    form{ display:grid; grid-template-columns:repeat(auto-fit,minmax(260px,1fr)); gap:16px }
    .full{ grid-column:1/-1 }

    label{ display:block; font-weight:700; margin-bottom:6px }

    input, select, textarea{
      width:100%; padding:12px 14px; border-radius:10px; font-family:inherit; font-size:1rem;
      background:var(--input-bg); color:var(--input-text); border:1px solid var(--input-border);
      outline:none; transition:border-color .2s ease, background-color .2s ease;
    }
    input:focus, select:focus, textarea:focus{ border-color:#59b5ff }

    select option{ color:#1f2937 }
    body.theme-dark select option{ color:#e2e8f0; background:#0b1e34; }

    textarea{ min-height:110px; resize:vertical }

    .actions{ display:flex; gap:10px; align-items:center; margin-top:6px }
    button[type="submit"]{
      background:var(--brand-2); color:#fff; border:none; border-radius:10px;
      padding:12px 18px; font-weight:700; cursor:pointer;
    }
    button[type="submit"]:hover{ background:#25625f }
    .back{ text-decoration:none; font-weight:700; color:var(--brand) }

    footer{ text-align:center; color:var(--muted); font-size:.95rem; padding:10px 0 24px }
    @media (max-width:480px){ header h1{font-size:1.5rem} }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <button id="themeToggle" class="theme-toggle" aria-label="تبديل الثيم" title="تبديل الثيم">
        <i class="fas fa-moon"></i>
      </button>

      <h1>احجز موعدًا الآن</h1>
      <p>املأ البيانات التالية وسنتواصل معك لتأكيد الموعد.</p>
    </header>

    <div class="content">
      <!-- يُرسل عبر FormSubmit إلى بريدك (بدّله لاحقًا لإيميل المركز) -->
      <form id="bookingForm"
            action="https://formsubmit.co/mshlool684@gmail.com"
            method="POST" accept-charset="UTF-8">
        <input type="hidden" name="_subject" value="طلب حجز جديد - موقع المركز">
        <input type="hidden" name="_template" value="table">
        <!-- أزلنا تعطيل الكابتشا ليعمل reCAPTCHA التلقائي -->
        <!-- <input type="hidden" name="_captcha" value="false"> -->
        <input type="hidden" name="_autoresponse"
               value="مرحبًا! تم استلام طلب الحجز. سنتواصل معك لتأكيد الموعد خلال ساعات الدوام (9 صباحًا – 5 مساءً).">
        <input type="hidden" name="_next" value="https://mohamad-alshlool03.github.io/scc/thanks.html">
        <!-- honeypot لمنع البوتات -->
        <input type="text" name="_honey" style="display:none">

        <div>
          <label for="name">الاسم الكامل *</label>
          <input id="name" name="الاسم الكامل" type="text" required autocomplete="name">
        </div>

        <div>
          <label for="phone">رقم الهاتف *</label>
          <input id="phone" name="رقم الهاتف" type="tel"
                 inputmode="tel" autocomplete="tel" required
                 pattern="^(?:\\+?9627\\d{8}|07\\d{8})$"
                 title="أدخل رقمًا أردنيًا مثل 07XXXXXXXX أو ‎+9627XXXXXXXX">
        </div>

        <div>
          <label for="email">البريد الإلكتروني</label>
          <input id="email" name="email" type="email" autocomplete="email" placeholder="اختياري">
        </div>

        <div>
          <label for="service">الخدمة المطلوبة *</label>
          <select id="service" name="الخدمة المطلوبة" required>
            <option value="" selected disabled>اختر خدمة</option>
            <option>علاج وتأهيل الإصابات الرياضية بمختلف أنواعها</option>
            <option>علاج الآلام العضلية</option>
            <option>علاج خشونة والتهاب المفاصل</option>
            <option>علاج الانزلاق الغضروفي (الديسك)</option>
            <option>علاج مشاكل جهاز التوازن</option>
            <option>علاج إصابات الجهاز العصبي مثل إصابات النخاع الشوكي والجلطات الدماغية</option>
            <option>قسم مختص بعلاج الأطفال مثل حالات الشلل الدماغي</option>
            <option>علاج مشاكل انحناء العمود الفقري</option>
            <option>التعامل مع حالات التوحد</option>
            <option>أخرى</option>
          </select>
        </div>

        <div>
          <label for="date">التاريخ المفضّل *</label>
          <input id="date" name="التاريخ المفضل" type="date" required>
        </div>

        <div>
          <label for="time">الوقت المفضّل *</label>
          <select id="time" name="الوقت المفضل" required>
            <option value="" selected disabled>اختر وقتًا</option>
          </select>
        </div>

        <div class="full">
          <label for="msg">ملاحظات إضافية</label>
          <textarea id="msg" name="ملاحظات إضافية" placeholder="اكتب وصفًا مختصرًا للحالة أو أي تفاصيل مهمة"></textarea>
        </div>

        <div class="full">
          <label style="display:flex; gap:8px; align-items:center; font-weight:600;">
            <input type="checkbox" required style="accent-color:#2c7a7b; width:18px; height:18px">
            أوافق على التواصل عبر الهاتف أو الواتساب لتأكيد الموعد.
          </label>
        </div>

        <div class="actions full">
          <button type="submit" id="submitBtn"><i class="fa-solid fa-paper-plane"></i> إرسال الطلب</button>
          <a class="back" href="index.html" rel="noopener">العودة للرئيسية</a>
        </div>
      </form>
    </div>

    <footer>© 2025 مركز الأبرز الإستشاري للعلاج الطبيعي</footer>
  </div>

  <script>
    /* ساعات الحجز: 9–17 وعلى رأس الساعة */
    const START = 9, END = 17;
    const form = document.getElementById('bookingForm');
    const dateInput = document.getElementById('date');
    const timeSelect = document.getElementById('time');
    const submitBtn = document.getElementById('submitBtn');

    const today = new Date(); today.setHours(0,0,0,0);
    dateInput.min = today.toISOString().split('T')[0];

    function isSameDay(a,b){ return a.getFullYear()===b.getFullYear() && a.getMonth()===b.getMonth() && a.getDate()===b.getDate(); }
    function labelFor(h){ if(h===0)return"12:00 ص"; if(h===12)return"12:00 م"; if(h<12)return String(h).padStart(2,'0')+":00 ص"; return String(h-12).padStart(2,'0')+":00 م"; }

    function buildOptions(forToday){
      timeSelect.innerHTML = '<option value="" selected disabled>اختر وقتًا</option>';
      const now = new Date();
      const nextHour = now.getMinutes()>0 ? now.getHours()+1 : now.getHours();
      for (let h=START; h<=END; h++){
        const hh = String(h).padStart(2,'0') + ':00';
        const opt = document.createElement('option');
        opt.value = hh;
        opt.textContent = labelFor(h);
        opt.disabled = forToday && h < nextHour;
        timeSelect.appendChild(opt);
      }
    }

    function refreshTimes(){
      const d = dateInput.value;
      if (!d){ timeSelect.innerHTML = '<option value="" selected disabled>اختر وقتًا</option>'; return; }
      const chosen = new Date(d + 'T00:00');
      buildOptions(isSameDay(chosen, today));
    }

    dateInput.value = dateInput.min;
    refreshTimes();
    dateInput.addEventListener('change', refreshTimes);

    /* تطبيع رقم الهاتف: 07XXXXXXXX -> +9627XXXXXXXX */
    form.addEventListener('submit', function(){
      // منع الإرسال المزدوج
      submitBtn.disabled = true;
      submitBtn.textContent = 'جاري الإرسال…';

      const phone = document.getElementById('phone');
      let v = phone.value.replace(/\s+/g,'');
      if (/^07\d{8}$/.test(v)) { v = '+962' + v.slice(1); }
      phone.value = v;
    });

    /* تبديل الثيم */
    const toggleBtn = document.getElementById('themeToggle');
    const ICON_MOON = '<i class="fas fa-moon"></i>';
    const ICON_SUN  = '<i class="fas fa-sun"></i>';
    const saved = localStorage.getItem('theme');
    if(saved === 'dark'){ document.body.classList.add('theme-dark'); toggleBtn.innerHTML = ICON_SUN; }
    else { document.body.classList.remove('theme-dark'); toggleBtn.innerHTML = ICON_MOON; }
    toggleBtn.addEventListener('click', () => {
      document.body.classList.toggle('theme-dark');
      const dark = document.body.classList.contains('theme-dark');
      toggleBtn.innerHTML = dark ? ICON_SUN : ICON_MOON;
      localStorage.setItem('theme', dark ? 'dark' : 'light');
    });
  </script>
</body>
</html>
